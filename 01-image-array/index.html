<!DOCTYPE html>
<html lang="zh">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>图像是数组 · 图像处理知识库</title>
<link rel="stylesheet" href="../assets/style.css">
<style>
.card::before{background:var(--c1);}
.section h2{color:var(--c1);}
.array-vis{
  background:var(--surface);
  border:1px solid var(--border2);
  border-radius:2px;
  padding:24px;
  margin:20px 0;
  overflow-x:auto;
}
.array-grid{
  display:inline-grid;
  grid-template-columns:repeat(6,1fr);
  gap:3px;
  margin-bottom:12px;
}
.array-cell{
  width:44px;height:44px;
  border-radius:2px;
  display:flex;align-items:center;justify-content:center;
  font-family:'JetBrains Mono',monospace;
  font-size:9px;color:rgba(255,255,255,0.6);
  border:1px solid rgba(255,255,255,0.05);
}
.array-caption{
  font-family:'JetBrains Mono',monospace;
  font-size:10px;color:var(--muted2);
  letter-spacing:2px;
}
</style>
</head>
<body>

<nav class="nav">
  <a href="../index.html" class="nav-home">知识库主页</a>
  <div class="nav-sep"></div>
  <div class="nav-title">Layer 01 · 数字图像的本质</div>
</nav>

<main class="main">

  <div class="page-header">
    <div class="page-eyebrow">LAYER 01 · 01 · IMAGE ARRAY</div>
    <h1 class="page-title">图像是<em>数组</em></h1>
    <p class="page-desc">计算机里的图像不是"一张画"，而是一个装满数字的三维数组。理解了这一点，就理解了所有图像处理的本质。</p>
    <div class="page-header-line"></div>
  </div>

  <!-- 核心概念 -->
  <div class="section">
    <div class="section-label">CORE CONCEPT</div>
    <h2>图像的本质结构</h2>
    <p>一张 3300 万像素的照片，在计算机里就是一个 <strong>4688 × 7028 × 3</strong> 的三维数组。第一个数是高度，第二个数是宽度，第三个数是颜色通道（红绿蓝）。</p>
    <p>每一个格子里存着一个数字，代表那个像素位置上该颜色通道的亮度值。所有图像操作，不管是调色、裁剪、模糊还是堆叠，本质上都是对这个数组做数学运算。</p>

    <div class="array-vis">
      <div class="array-grid" id="colorGrid"></div>
      <div class="array-caption">↑ 6×6 像素示意图，每个格子是一个数值（R通道）</div>
    </div>
  </div>

  <!-- 三个维度 -->
  <div class="section">
    <div class="section-label">STRUCTURE</div>
    <h2>三个维度各代表什么</h2>
    <div class="cards">
      <div class="card">
        <h3>维度一：高度 H</h3>
        <p>图像有多少行像素。索尼 A7 系列全画幅传感器高度约 4688 个像素，从上到下编号 0 到 4687。</p>
      </div>
      <div class="card">
        <h3>维度二：宽度 W</h3>
        <p>图像有多少列像素。宽度约 7028 个像素，从左到右编号 0 到 7027。</p>
      </div>
      <div class="card">
        <h3>维度三：通道 C</h3>
        <p>每个像素位置有三个数值，分别代表红(R)、绿(G)、蓝(B)通道的亮度。三个数合在一起决定这个像素的颜色。比如 RGB(255, 0, 0) 是纯红，RGB(0, 0, 0) 是纯黑，RGB(255, 255, 255) 是纯白。</p>
      </div>
    </div>
  </div>

  <!-- 数据类型 -->
  <div class="section">
    <div class="section-label">DATA TYPE</div>
    <h2>数组里存的是什么类型的数字</h2>
    <p>数字的类型决定了能存多大的范围：</p>
    <div class="cards">
      <div class="card">
        <h3>uint8（8bit无符号整数）</h3>
        <p>范围 0~255，占 1 字节。JPEG 和普通显示用这个，256 个亮度级别。</p>
      </div>
      <div class="card">
        <h3>uint16（16bit无符号整数）</h3>
        <p>范围 0~65535，占 2 字节。16bit TIFF 用这个，65536 个亮度级别，后期调色空间大。</p>
      </div>
    </div>

    <div class="data-box">
      <div class="data-label">亲测实验数据 · 2026.02</div>
      <pre>
索尼 ARW 文件用 rawpy 读取后：
  图像形状：(4688, 7028, 3)
  数据类型：uint16
  数值范围：0 ~ 65535
  总像素数：4688 × 7028 = 32,963,264 ≈ 3300万</pre>
    </div>
  </div>

  <!-- 所有操作都是数学 -->
  <div class="section">
    <div class="section-label">KEY INSIGHT</div>
    <h2>所有图像处理 = 对数组做数学</h2>
    <div class="cards">
      <div class="card">
        <h3>裁剪</h3>
        <p>取数组的一个子集，比如 img[100:500, 200:800, :] 就裁出一个 400×600 的区域。</p>
      </div>
      <div class="card">
        <h3>调亮度</h3>
        <p>数组每个元素乘以一个系数，比如全部乘以 1.5 就提亮 50%。</p>
      </div>
      <div class="card">
        <h3>堆叠多张照片（Average模式）</h3>
        <p>把多个数组对应位置的数值相加再除以张数，相当于取每个像素位置的平均值，随机噪点被平均掉。</p>
      </div>
      <div class="card">
        <h3>模糊</h3>
        <p>用周围像素的加权平均值替换当前像素，本质是对数组做卷积运算（第二层内容）。</p>
      </div>
    </div>

    <div class="insight">
      <div class="insight-label">核心领悟</div>
      <p>看起来神秘的图像处理，底层全是对数字的加减乘除。理解了这一点，再复杂的算法也只是数学操作的组合，没有魔法。</p>
    </div>
  </div>

  <!-- 代码示例 -->
  <div class="section">
    <div class="section-label">CODE</div>
    <h2>用代码感受"图像是数组"</h2>
    <div class="code-block">
      <div class="code-label">PYTHON · RAWPY + NUMPY</div>
      <pre>import rawpy
import numpy as np

with rawpy.imread("your_photo.ARW") as raw:
    img = raw.postprocess(output_bps=16, use_camera_wb=True)

# 查看数组基本信息
print("图像形状:", img.shape)       # (4688, 7028, 3)
print("数据类型:", img.dtype)       # uint16
print("最大值:", img.max())         # 65535
print("最小值:", img.min())         # 0

# 取一个像素看看它的RGB值
pixel = img[2344, 3514]            # 中心像素
print("中心像素RGB:", pixel)        # [R, G, B]

# 提亮：所有像素值乘以1.2
brightened = np.clip(img * 1.2, 0, 65535).astype(np.uint16)</pre>
    </div>
  </div>

  <!-- 资料 -->
  <div class="resources">
    <div class="resources-header">
      <h2>推荐学习资料</h2>
    </div>
    <div class="resource-grid">
      <a href="https://numpy.org/doc/stable/user/quickstart.html" target="_blank" class="resource-item">
        <div class="resource-type">官方文档 · NUMPY</div>
        <div class="resource-title">NumPy Quickstart Tutorial</div>
        <div class="resource-desc">数组操作基础，图像处理的数学底座，必读</div>
      </a>
      <a href="https://docs.opencv.org/4.x/d6/d00/tutorial_py_root.html" target="_blank" class="resource-item">
        <div class="resource-type">官方教程 · OPENCV</div>
        <div class="resource-title">OpenCV-Python Tutorials</div>
        <div class="resource-desc">第一章 Core Operations 讲图像数组操作，10分钟入门</div>
      </a>
      <a href="https://www.cambridge.org/highereducation/books/digital-image-processing/BF6800B7D4B7E0AA3D9E81B09AD4D41C" target="_blank" class="resource-item">
        <div class="resource-type">教材 · 经典</div>
        <div class="resource-title">Digital Image Processing (Gonzalez)</div>
        <div class="resource-desc">图像处理圣经，第2章讲数字图像基础，看前两章就够</div>
      </a>
      <a href="https://rawpedia.rawtherapee.com/Main_Page" target="_blank" class="resource-item">
        <div class="resource-type">参考资料 · RAW</div>
        <div class="resource-title">RawPedia</div>
        <div class="resource-desc">RAW处理最详细的技术文档，解释了RAW文件结构和处理流程</div>
      </a>
    </div>
  </div>

  <div class="bottom-nav">
    <a href="../index.html" class="btn-nav">← 返回主页</a>
    <a href="../02-sensor-raw/index.html" class="btn-nav">传感器与RAW →</a>
  </div>

</main>

<script>
// 生成彩色数组可视化
const grid = document.getElementById('colorGrid');
const values = [
  [180,190,170,160,175,185],
  [165,200,185,170,160,175],
  [175,185,195,180,170,165],
  [190,170,165,200,185,175],
  [160,175,185,170,195,180],
  [185,165,175,185,165,190]
];
values.forEach(row => {
  row.forEach(v => {
    const cell = document.createElement('div');
    cell.className = 'array-cell';
    cell.style.background = `rgba(${Math.round(v*0.4)}, ${Math.round(v*0.7)}, ${Math.round(v*0.9)}, 0.8)`;
    cell.textContent = v;
    grid.appendChild(cell);
  });
});
</script>

</body>
</html>
